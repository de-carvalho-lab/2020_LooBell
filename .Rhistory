abline(h = -log10(0.05), lty = 2, lwd = 1.5)
-log10(0.05)
head(meth.diff[[1]])
for(i in 1:length(meth.diff)){
x <- meth.diff[[i]]$meth.diff
q <- meth.diff[[i]]$qvalue
y <- -log10(x = q)
plot(x = x, y = y, xlim = xlim, ylim = ylim, xlab = xlab, ylab = ylab, col = "grey", pch = 20, las = 1, main = main[i])
abline(h = -log10(0.05), lty = 2, lwd = 1.5)
}
main <- c("Stimulated Vs Unstimulated T-cells","Stimulated + DAC Vs Stimulated T-cells")
ylim <- c(0,1)
xlim <- c(-100,100)
xlab <- expression(paste(Delta," methylation (%)"))
ylab <- expression(paste("-Log"[10],"(q-value)"))
for(i in 1:length(meth.diff)){
x <- meth.diff[[i]]$meth.diff
q <- meth.diff[[i]]$qvalue
y <- -log10(x = q)
plot(x = x, y = y, xlim = xlim, ylim = ylim, xlab = xlab, ylab = ylab, col = "grey", pch = 20, las = 1, main = main[i])
abline(h = -log10(0.05), lty = 2, lwd = 1.5)
}
main <- c("Stimulated Vs Unstimulated T-cells","Stimulated + DAC Vs Stimulated T-cells")
xlim <- c(-100,100)
xlab <- expression(paste(Delta," methylation (%)"))
ylab <- expression(paste("-Log"[10],"(q-value)"))
for(i in 1:length(meth.diff)){
x <- meth.diff[[i]]$meth.diff
q <- meth.diff[[i]]$qvalue
y <- -log10(x = q)
plot(x = x, y = y, xlim = xlim, xlab = xlab, ylab = ylab, col = "grey", pch = 20, las = 1, main = main[i])
abline(h = -log10(0.05), lty = 2, lwd = 1.5)
}
fig.names <- c("RRBS_03_volcano.png","RRBS_S03_volcano.png")
for(i in 1:length(meth.diff)){
x <- meth.diff[[i]]$meth.diff
q <- meth.diff[[i]]$qvalue
y <- -log10(x = q)
png.name <- file.path(r.config$dirs$figure.dir,fig.names[i])
png(filename = png.name, width = r.config$fig.specs$width, height = r.config$fig.specs$height, units = r.config$fig.specs$units, res = r.config$fig.specs$res, pointsize = r.config$fig.specs$pointsize)
plot(x = x, y = y, xlim = xlim, xlab = xlab, ylab = ylab, col = "grey", pch = 20, las = 1, main = main[i])
abline(h = -log10(0.05), lty = 2, lwd = 1.5)
dev.off()
}
fig.names <- c("RRBS_03_volcano.png","RRBS_S03_volcano.png")
for(i in 1:length(meth.diff)){
x <- meth.diff[[i]]$meth.diff
q <- meth.diff[[i]]$qvalue
y <- -log10(x = q)
png.name <- file.path(r.config$dirs$figure.dir,fig.names[i])
png(filename = png.name, width = 4.5, height = 4.5, units = r.config$fig.specs$units, res = r.config$fig.specs$res, pointsize = r.config$fig.specs$pointsize)
plot(x = x, y = y, xlim = xlim, xlab = xlab, ylab = ylab, col = "grey", pch = 20, las = 1, main = main[i])
abline(h = -log10(0.05), lty = 2, lwd = 1.5)
dev.off()
}
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = simple.col[3], main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
hist(x = signif$meth.diff, col = r.config$simple.cols[3], main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2, at = seq(0,x.max,20000), labels = seq(0,x.max,20000)/1000, las = 1)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2, at = seq(0,x.max,20000), labels = seq(0,x.max,20000)/1000, las = 1)
axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
# axis(side = 2, at = seq(0,x.max,20000), labels = seq(0,x.max,20000)/1000, las = 1)
axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, ylim = ylim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2)
axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2)
# axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2, labels = seq(0,x.max,10000)/1000, las = 1)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
# axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2, at = seq(0,50000,10000), labels = seq(0,x.max,10000)/1000, las = 1)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab)
axis(side = 1)
axis(side = 2, at = seq(0,50000,10000), labels = seq(0,50000,10000)/1000, las = 1)
# axis(side = 2, at = seq(0,x.max,10000), labels = seq(0,x.max,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
tiles <- tileMethylCounts(object = meth.unite[[2]], win.size = 200, step.size = 200, mc.cores = 10)
tiles.bed <- data.frame(chromosome = tiles$chr, start = tiles$start, end = tiles$end, unique_peak_id = paste0("uid_",1:nrow(tiles)), not_used = "", strand = "*")
write.table(x = tiles.bed, file = file.path(r.config$dirs$augmented.data.dir,"01_rrbs_methylKit","RRBS_allTiles.bed"), quote = FALSE, sep = "\t", row.names = FALSE, col.names = FALSE)
signif.hypo <- signif[which(signif$meth.diff <= this.min),]
signif.tiles.bed <- data.frame(chromosome = signif.hypo$chr, start = signif.hypo$start, end = signif.hypo$end, unique_peak_id = paste0("uid_",1:nrow(signif.hypo)), not_used = "", strand = "*")
write.table(x = signif.tiles.bed, file = file.path(r.config$dirs$augmented.data.dir,"01_rrbs_methylKit","RRBS_signifHypoTiles.bed"), quote = FALSE, sep = "\t", row.names = FALSE, col.names = FALSE)
signif.hypo <- signif[which(signif$meth.diff <= this.min),]
signif.tiles.bed <- data.frame(chromosome = signif.hypo$chr, start = signif.hypo$start, end = signif.hypo$end, unique_peak_id = paste0("uid_",1:nrow(signif.hypo)), not_used = "", strand = "*")
write.table(x = signif.tiles.bed, file = file.path(r.config$dirs$augmented.data.dir,"01_rrbs_methylKit","RRBS_signifHypoTiles.bed"), quote = FALSE, sep = "\t", row.names = FALSE, col.names = FALSE)
homer <- read.table(file = file.path(data.dir,"03_augmented","03_rrbs_homer","hypomethVsUndiff","knownResults.txt"), header = FALSE, sep = "\t", skip = 1, col.names = c("Motif","Consensus","P-value","Log P-value","q-value","N FG","PC FG","N BG","PC BG"), stringsAsFactors = FALSE)
homer <- read.table(file = file.path("data/03_augmented/02_rrbs_homer/hypomethTilesVsAllTiles","knownResults.txt"), header = FALSE, sep = "\t", skip = 1, col.names = c("Motif","Consensus","P-value","Log P-value","q-value","N FG","PC FG","N BG","PC BG"), stringsAsFactors = FALSE)
head(homer)
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
mef.index
mef.name
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(q-value)"))
plot(x = 1:nrow(homer), y = log.p, pch = 20, col = point.col, xlab = "Rank", ylab = ylab)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = simple.col[3])
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
plot(x = 1:nrow(homer), y = log.p, pch = 20, col = point.col, xlab = "Rank", ylab = ylab)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(q-value)"))
plot(x = 1:nrow(homer), y = log.p, pch = 20, col = point.col, xlab = "Rank", ylab = ylab)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
plot(x = 1:nrow(homer), y = log.p, pch = 20, col = point.col, xlab = "Rank", ylab = ylab)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, axes = FALSE)
axis(side = 1)
axis(side = 2)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, axes = FALSE)
axis(side = 1)
axis(side = 2)
axis(side = 3)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col,yaxt="n",)
axis(side = 1)
axis(side = 2)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, yaxt="n")
axis(side = 1)
axis(side = 2)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, yaxt = "n")
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col)
seq(0,15000,5000)
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at)
y.labels
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
y.labels
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, yaxt = "n")
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col)
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
par(mar = c(4,6,2,2))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = ylab, pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
par(mar = c(4,6,2,2))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
mtext(text = y.lab, side = 2, line = 3)
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
par(mar = c(4,6,2,2))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
mtext(text = ylab, side = 2, line = 3)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
par(mar = c(4,6,2,2))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
mtext(text = ylab, side = 2, line = 4)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
mef.index <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE)
mef.name <- grep(pattern = "Mef", x = homer$Motif, ignore.case = FALSE, value = TRUE)
mef.name <- substr(x = mef.name, start = 1, stop = 5)
mef.name <- toupper(mef.name)
log.p <- homer$Log.P.value
log.p <- log.p * -1
point.col <- rep("black",nrow(homer))
point.col[which(homer$q.value < 0.05)] <- "grey"
ylab <- expression(paste("-Log"[10],"(p-value)"))
y.at <- seq(0,15000,5000)
y.labels <- prettyNum(x = y.at, big.mark = ",", big.interval = 3)
par(mar = c(4,6,2,2))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = "", pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
mtext(text = ylab, side = 2, line = 4)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), axes = FALSE, ylab = "Frequency (1,000 windows)", xlab = xlab, yaxt = "n")
axis(side = 1)
axis(side = 2, at = seq(0,50000,10000), labels = seq(0,50000,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
signif <- meth.diff[[2]][which(meth.diff[[2]]$qvalue <= 0.05),]
xlim <- c(-100,100)
ylim <- c(0,50)
xlab <- expression(paste(Delta, " methylation (%)"))
par(mar = c(4,4,2,2))
hp <- hist(x = signif$meth.diff, plot = FALSE)
x.max <- round(max(hp$counts), -5)
hist(x = signif$meth.diff, col = "grey", main = "", xlim = xlim, las = 1, breaks = seq(-100,100,5), ylab = "Frequency (1,000 windows)", xlab = xlab, yaxt = "n")
axis(side = 1)
axis(side = 2, at = seq(0,50000,10000), labels = seq(0,50000,10000)/1000, las = 1)
dens <- density(x = signif$meth.diff)
this.min <- optimize(approxfun(dens$x,dens$y),interval=c(-50,0))$minimum
abline(v = this.min, col = "black", lty = 2, lwd = 1.5)
png.name <- file.path(r.config$dirs$figure.dir,"RRBS_05_homerRanks.png")
png(filename = png.name, width = 4.5, height = 4.5, units = r.config$fig.specs$units, res = r.config$fig.specs$res, pointsize = r.config$fig.specs$pointsize)
par(mar = c(4,6,2,2))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = "", pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
mtext(text = ylab, side = 2, line = 4)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
dev.off()
png.name <- file.path(r.config$dirs$figure.dir,"RRBS_05_homerRanks.png")
png(filename = png.name, width = 4.5, height = 4.5, units = r.config$fig.specs$units, res = r.config$fig.specs$res, pointsize = r.config$fig.specs$pointsize)
par(mar = c(4,6,0,0))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = "", pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
mtext(text = ylab, side = 2, line = 4)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
dev.off()
png.name <- file.path(r.config$dirs$figure.dir,"RRBS_05_homerRanks.png")
png(filename = png.name, width = 4.5, height = 4.5, units = r.config$fig.specs$units, res = r.config$fig.specs$res, pointsize = r.config$fig.specs$pointsize)
par(mar = c(4,6,1,1))
plot(x = 1:nrow(homer), y = log.p, xlab = "Rank", ylab = "", pch = 20, col = point.col, yaxt = "n")
axis(side = 1)
axis(side = 2, at = y.at, labels = y.labels, tick = TRUE, las = 1)
mtext(text = ylab, side = 2, line = 4)
points(x = mef.index, y = log.p[mef.index], pch = 20, col = r.config$simple.cols[3])
text(x = mef.index, y = log.p[mef.index], labels = mef.name, adj = 0, pos = c(4,4,4,3))
dev.off()
head(meth.diff[[1]])
df <- getData(x = meth.diff[[1]])
head(df)
nrow(df)
meth.df <- bplapply(X = meth.diff, FUN = function(X) getData, BPPARAM = param)
library(writexl)
BiocManager::install("writexl")
library(writexl)
write_xlsx(x = meth.df, path = file.path(r.config$dirs$table.dir,"RRBS_SupplementaryTable_01.xlsx"), col_names = TRUE)
class(meth.df)
class(meth.df[[1]])
head(meth.df[[1]])
meth.df <- bplapply(X = meth.diff, FUN = function(X) getData(X), BPPARAM = param)
write_xlsx(x = meth.df, path = file.path(r.config$dirs$table.dir,"RRBS_SupplementaryTable_01.xlsx"), col_names = TRUE)
comparisons
meth.df <- bplapply(X = meth.diff, FUN = function(X) getData(X), BPPARAM = param)
names(meth.df) <- comparisons
write_xlsx(x = meth.df, path = file.path(r.config$dirs$table.dir,"RRBS_SupplementaryTable_01.xlsx"), col_names = TRUE)
