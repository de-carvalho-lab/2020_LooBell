base.dir <- file.path("2020_LooBell_NatureMedicine")
data.dir <- file.path(base.dir,"data")
docs.dir <- file.path(base.dir,"docs")
results.dir <- file.path(base.dir,"results")
figure.dir <- file.path(base.dir,"results","figures")
table.dir <- file.path(base.dir,"results","tables")
units <- "cm"
width <- 6
height <- 6
res <- 480
pointsize <- 6
library(viridis)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names(unlist(fig.cols)), horiz = TRUE, las = 1, axes = FALSE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = "grey", names.arg = names(unlist(fig.cols)), horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = "black")
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names(unlist(fig.cols)), horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = "black")
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names(unlist(fig.cols)), horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white"),c(5,1))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names(unlist(fig.cols)), horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white"),c(5,1)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names(unlist(fig.cols)), horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,1,5)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names(unlist(fig.cols)), horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
names(unlist(fig.cols))
names(fig.cols)
fig.cols
sapply(X = unlist(fig.cols), FUN = function(X) names)
sapply(X = unlist(fig.cols), FUN = function(X) names(X))
unlist(fig.cols)
sapply(X = fig.cols, FUN = function(X) names(X))
unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 1, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 1, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = "DAC", side = 1, las = 1)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = "DAC", side = 2, las = 1)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = "DAC", side = 2, las = 1, line = 5, at = 1.5)
bp
names(fig.cols)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 5, at = side.y)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-1,-1), y = bp[1:3,1], xpd = TRUE)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-1,-1), y = bp[c(1,3),1], xpd = TRUE)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-5,-5), y = bp[c(1,3),1], xpd = TRUE)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-4,-4), y = bp[c(1,3),1], xpd = TRUE)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,20,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-4,-4), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,10,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-4,-4), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,15,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-4,-4), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,12,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-4,-4), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-4,-4), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,12,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-2,-2), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-2,-2), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-2,-2), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,12,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-2,-2), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-3,-3), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-3,-3), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,12,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-2,-2), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.5,-2.5), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.5,-2.5), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,12,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-2,-2), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.7,-2.7), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.5,-2.5), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,12,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 2, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-2.2,-2.2), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.7,-2.7), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.5,-2.5), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
pal <- inferno(n = 9, begin = 0.2, end = 0.8)
pal2 <- inferno(n = 9, begin = 0.2, end = 0.8, alpha = 0.5)
fig.cols <- list(
Donor = c(`Donor 1`=pal2[1], `Donor 2`=pal[1], `Donor 3`=pal[2]),
Stimulated = c(Unstimulated="#DEA3AF",Stimulated=pal[5]),
DAC = c(Untreated="lightgrey",Treated=pal[7]))
names.arg <- unlist(sapply(X = fig.cols, FUN = function(X) names(X)))
side.names <- names(fig.cols)
simple.cols <- unlist(fig.cols)[c(4,5,7)]
par(mar = c(2,12,2,2), xpd = TRUE)
bp <- barplot(height = rep(x = 9, times = length(unlist(fig.cols))), col = unlist(fig.cols), names.arg = names.arg, horiz = TRUE, las = 1, axes = FALSE)
side.y <- c(mean(bp[1:3,1]),mean(bp[4:5,1]),mean(bp[6:7]))
text(x = 1.5, y = bp[,1], labels = unlist(fig.cols), cex = 0.7, col = rep(c("black","white","black"),c(1,2,4)))
mtext(text = side.names, side = 2, las = 1, line = 7, at = side.y)
lines(x = c(-2.2,-2.2), y = bp[c(1,3),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.7,-2.7), y = bp[c(4,5),1], xpd = TRUE, lwd = 2)
lines(x = c(-2.5,-2.5), y = bp[c(6,7),1], xpd = TRUE, lwd = 2)
